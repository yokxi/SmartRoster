<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartRoster - Schedule Management</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;800&family=JetBrains+Mono&display=swap"
        rel="stylesheet">
</head>

<body>

    <div class="container">
        <header>
            <h1>SmartRoster</h1>
            <div class="subtitle">Intelligent Schedule Management System</div>
        </header>

        <form action="/generate" method="post">

            <div class="card">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="employees_input">1. Team Configuration</label>
                        <div class="helper-text">Format: Name, MonthlyTargetHours</div>
                        <textarea id="employees_input" name="employees_input" spellcheck="false">Anna,160
Marco,160
Luca,80
Sara,160</textarea>
                    </div>

                    <div class="form-group">
                        <label>2. Shift Requirements</label>
                        <div class="helper-text">Add shifts for each day.</div>

                        <div id="schedule-container">
                        </div>

                        <button type="button" id="add-shift-btn" class="secondary-btn">+ Add Shift</button>
                    </div>

                    <div class="form-group">
                        <label>3. Holidays & Special Dates</label>
                        <div class="helper-text">Add holidays or special shifts.</div>

                        <div id="holiday-container">
                        </div>

                        <button type="button" id="add-holiday-btn" class="secondary-btn">+ Add Holiday/Special
                            Date</button>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="form-group full-width">
                    <label>4. Period Selection</label>
                    <div class="period-controls">
                        <div class="control-group">
                            <label for="month">Month:</label>
                            <select id="month" name="month">
                                <option value="1">January</option>
                                <option value="2">February</option>
                                <option value="3">March</option>
                                <option value="4">April</option>
                                <option value="5">May</option>
                                <option value="6">June</option>
                                <option value="7">July</option>
                                <option value="8">August</option>
                                <option value="9">September</option>
                                <option value="10">October</option>
                                <option value="11" selected>November</option>
                                <option value="12">December</option>
                            </select>
                        </div>

                        <div class="control-group">
                            <label for="year">Year:</label>
                            <input type="number" id="year" name="year" value="2025" min="2024" max="2030">
                        </div>
                    </div>
                </div>
            </div>

            <button type="submit">Generate Calendar Schedule</button>

        </form>

        <footer>
            &copy; 2025 SmartRoster System. All rights reserved.
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const container = document.getElementById('schedule-container');
            const addBtn = document.getElementById('add-shift-btn');

            const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];

            const defaultShifts = [
                { day: 'Monday', start: '09:00', end: '13:00', staff: 2 },
                { day: 'Monday', start: '13:00', end: '18:00', staff: 1 },
                { day: 'Tuesday', start: '09:00', end: '13:00', staff: 2 },
                { day: 'Tuesday', start: '13:00', end: '18:00', staff: 1 },
                { day: 'Wednesday', start: '09:00', end: '13:00', staff: 2 },
                { day: 'Wednesday', start: '13:00', end: '18:00', staff: 1 },
                { day: 'Thursday', start: '09:00', end: '13:00', staff: 2 },
                { day: 'Thursday', start: '13:00', end: '18:00', staff: 1 },
                { day: 'Friday', start: '09:00', end: '13:00', staff: 2 },
                { day: 'Friday', start: '13:00', end: '18:00', staff: 1 },
                { day: 'Saturday', start: '10:00', end: '14:00', staff: 2 },
                { day: 'Saturday', start: '14:00', end: '19:00', staff: 2 },
                { day: 'Sunday', start: '10:00', end: '14:00', staff: 1 }
            ];

            function createRow(data = null) {
                const row = document.createElement('div');
                row.className = 'schedule-row';
                row.style.display = 'flex';
                row.style.gap = '10px';
                row.style.marginBottom = '10px';
                row.style.alignItems = 'center';

                const daySelect = document.createElement('select');
                daySelect.name = 'day[]';
                days.forEach(day => {
                    const option = document.createElement('option');
                    option.value = day;
                    option.textContent = day;
                    if (data && data.day === day) option.selected = true;
                    daySelect.appendChild(option);
                });

                const startTime = document.createElement('input');
                startTime.type = 'time';
                startTime.name = 'start_time[]';
                startTime.required = true;
                if (data) startTime.value = data.start;

                const sep = document.createElement('span');
                sep.textContent = '-';

                const endTime = document.createElement('input');
                endTime.type = 'time';
                endTime.name = 'end_time[]';
                endTime.required = true;
                if (data) endTime.value = data.end;

                const staffCount = document.createElement('input');
                staffCount.type = 'number';
                staffCount.name = 'staff_count[]';
                staffCount.placeholder = 'Staff';
                staffCount.min = '1';
                staffCount.style.width = '60px';
                staffCount.required = true;
                if (data) staffCount.value = data.staff;

                const removeBtn = document.createElement('button');
                removeBtn.type = 'button';
                removeBtn.textContent = '×';
                removeBtn.className = 'remove-btn';
                removeBtn.style.background = '#ff4444';
                removeBtn.style.color = 'white';
                removeBtn.style.border = 'none';
                removeBtn.style.borderRadius = '4px';
                removeBtn.style.cursor = 'pointer';
                removeBtn.style.padding = '0 8px';
                removeBtn.onclick = function () {
                    row.remove();
                };

                row.appendChild(daySelect);
                row.appendChild(startTime);
                row.appendChild(sep);
                row.appendChild(endTime);
                row.appendChild(staffCount);
                row.appendChild(removeBtn);

                return row;
            }

            defaultShifts.forEach(shift => {
                container.appendChild(createRow(shift));
            });

            addBtn.addEventListener('click', () => {
                container.appendChild(createRow());
            });

            const holidayContainer = document.getElementById('holiday-container');
            const addHolidayBtn = document.getElementById('add-holiday-btn');

            function createHolidayRow(data = null) {
                const row = document.createElement('div');
                row.className = 'holiday-row';
                row.style.display = 'flex';
                row.style.gap = '10px';
                row.style.marginBottom = '10px';
                row.style.alignItems = 'center';
                row.style.flexWrap = 'wrap';

                const dateInput = document.createElement('input');
                dateInput.type = 'date';
                dateInput.name = 'holiday_date[]';
                dateInput.required = true;
                dateInput.style.padding = '8px';
                dateInput.style.fontSize = '16px';
                if (data) dateInput.value = data.date;

                const typeSelect = document.createElement('select');
                typeSelect.name = 'holiday_type[]';
                typeSelect.style.padding = '8px';
                typeSelect.style.fontSize = '16px';
                const typeClosed = document.createElement('option');
                typeClosed.value = 'CLOSED';
                typeClosed.textContent = 'Closed';
                const typeSpecial = document.createElement('option');
                typeSpecial.value = 'SPECIAL';
                typeSpecial.textContent = 'Special Shift';
                typeSelect.appendChild(typeClosed);
                typeSelect.appendChild(typeSpecial);
                if (data && data.type) typeSelect.value = data.type;

                const specialContainer = document.createElement('div');
                specialContainer.style.display = 'none';
                specialContainer.style.gap = '10px';
                specialContainer.style.alignItems = 'center';

                const startTime = document.createElement('input');
                startTime.type = 'time';
                startTime.name = 'holiday_start[]';
                startTime.style.padding = '8px';
                startTime.style.fontSize = '16px';
                if (data) startTime.value = data.start;

                const sep = document.createElement('span');
                sep.textContent = '-';
                sep.style.fontSize = '16px';
                sep.style.fontWeight = 'bold';

                const endTime = document.createElement('input');
                endTime.type = 'time';
                endTime.name = 'holiday_end[]';
                endTime.style.padding = '8px';
                endTime.style.fontSize = '16px';
                if (data) endTime.value = data.end;

                const staffCount = document.createElement('input');
                staffCount.type = 'number';
                staffCount.name = 'holiday_staff[]';
                staffCount.placeholder = 'Staff';
                staffCount.min = '1';
                staffCount.style.width = '80px';
                staffCount.style.padding = '8px';
                staffCount.style.fontSize = '16px';
                if (data) staffCount.value = data.staff;

                specialContainer.appendChild(startTime);
                specialContainer.appendChild(sep);
                specialContainer.appendChild(endTime);
                specialContainer.appendChild(staffCount);

                function toggleSpecial() {
                    if (typeSelect.value === 'SPECIAL') {
                        specialContainer.style.display = 'flex';
                        startTime.required = true;
                        endTime.required = true;
                        staffCount.required = true;
                    } else {
                        specialContainer.style.display = 'none';
                        startTime.required = false;
                        endTime.required = false;
                        staffCount.required = false;
                    }
                }
                typeSelect.addEventListener('change', toggleSpecial);
                if (data && data.type === 'SPECIAL') toggleSpecial();

                const removeBtn = document.createElement('button');
                removeBtn.type = 'button';
                removeBtn.textContent = '×';
                removeBtn.className = 'remove-btn';
                removeBtn.style.background = '#ff4444';
                removeBtn.style.color = 'white';
                removeBtn.style.border = 'none';
                removeBtn.style.borderRadius = '4px';
                removeBtn.style.cursor = 'pointer';
                removeBtn.style.padding = '8px 12px';
                removeBtn.style.fontSize = '16px';
                removeBtn.onclick = function () {
                    row.remove();
                };

                row.appendChild(dateInput);
                row.appendChild(typeSelect);
                row.appendChild(specialContainer);
                row.appendChild(removeBtn);

                return row;
            }

            addHolidayBtn.addEventListener('click', () => {
                holidayContainer.appendChild(createHolidayRow());
            });
        });
    </script>

</body>

</html>